import React from 'react';
import style from './KeyboardWindow.module.scss';
import { sendAnswer } from '../../toServer/requests';
// import moment from 'moment';

class KeyboardWindow extends React.Component<any, any> {
  constructor(props: any) {
    super(props);
    this.state = {
      value: '',
      isCount: true,
      startTime: '',
      endTime: null,
      time: 0,
    };
  }

  public update = (code: string) => () => {
    if(this.state.isCount){
      this.setState({
        value: code !== 'delete' ? this.state.value + code : this.state.value.slice(0, -1),
      });
    }
  };

  public timer = () => {
    const timerId = setInterval(()=>this.setState({
      time: this.state.time + 5
    }) , 50);
    console.log(this.state.time)
    if(!this.state.isCount){clearInterval(timerId)}
  }

  public send = () => {
    const endTime = this.state.time;
    if(this.state.isCount){
      sendAnswer(endTime, Number(this.state.value))
      this.setState({
        isCount: false,
        endTime
      })
    }
  }

  public componentDidMount(){
    console.log('начинаем отсчет');
    const date = new Date().valueOf();
    this.setState({
      startTime: date
    })
    // setTimeout(this.timer, 10000);
  }
  
  render() {
    return (
      <div className={style.modal_back}>
        <div className={style.main}>
          <div className={style.question_text}>
            <p>
              {this.props.question}
            </p>
          </div>
          <div className={style.input}>
            <input name="value" type="text" readOnly value={this.state.value} />
          </div>
          <div className={style.footer}>
            <div className={style.timer}>
              <p>{this.state.isCount ? this.state.time/100 : this.state.endTime/100}</p>
            </div>

            <div className={style.keyboard}>

              <svg viewBox="0 0 1376 583" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  name="1"
                  onClick={this.update('1')}
                  d="M0 5.01538C0 2.24546 2.7203 0 6.07595 0H313.924C317.28 0 320 2.24546 320 5.01538V167.985C320 170.755 317.28 173 313.924 173H6.07595C2.7203 173 0 170.755 0 167.985V5.01538Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('1')}
                  d="M145.199 108.34H157.799V64.78L158.699 59.47L155.099 63.7L145.199 70.81L141.779 66.22L161.579 50.92H164.819V108.34H177.149V115H145.199V108.34Z"
                  fill="#7B6442"
                />
                <path
                  name="2"
                  onClick={this.update('2')}
                  d="M352 5.01538C352 2.24546 354.72 0 358.076 0H665.924C669.28 0 672 2.24546 672 5.01538V167.985C672 170.755 669.28 173 665.924 173H358.076C354.72 173 352 170.755 352 167.985V5.01538Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('2')}
                  d="M527.619 66.31C527.619 69.49 527.019 72.76 525.819 76.12C524.679 79.42 523.149 82.75 521.229 86.11C519.369 89.47 517.269 92.77 514.929 96.01C512.589 99.19 510.249 102.22 507.909 105.1L503.499 108.97V109.33L509.259 108.34H528.879V115H493.059V112.39C494.379 111.01 495.969 109.3 497.829 107.26C499.689 105.22 501.609 102.97 503.589 100.51C505.629 97.99 507.609 95.35 509.529 92.59C511.509 89.77 513.279 86.92 514.839 84.04C516.459 81.16 517.749 78.31 518.709 75.49C519.669 72.67 520.149 70 520.149 67.48C520.149 64.54 519.309 62.11 517.629 60.19C515.949 58.21 513.399 57.22 509.979 57.22C507.699 57.22 505.479 57.7 503.319 58.66C501.159 59.56 499.299 60.61 497.739 61.81L494.769 56.68C496.869 54.88 499.359 53.47 502.239 52.45C505.119 51.43 508.209 50.92 511.509 50.92C514.089 50.92 516.369 51.31 518.349 52.09C520.329 52.81 522.009 53.86 523.389 55.24C524.769 56.62 525.819 58.27 526.539 60.19C527.259 62.05 527.619 64.09 527.619 66.31Z"
                  fill="#7B6442"
                />
                <path
                  name="3"
                  onClick={this.update('3')}
                  d="M704 5.01538C704 2.24546 706.72 0 710.076 0H1017.92C1021.28 0 1024 2.24546 1024 5.01538V167.985C1024 170.755 1021.28 173 1017.92 173H710.076C706.72 173 704 170.755 704 167.985V5.01538Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('3')}
                  d="M860.539 109.78C862.579 109.78 864.469 109.48 866.209 108.88C867.949 108.28 869.449 107.41 870.709 106.27C871.969 105.07 872.959 103.66 873.679 102.04C874.399 100.42 874.759 98.65 874.759 96.73C874.759 92.53 873.499 89.41 870.979 87.37C868.519 85.33 865.099 84.31 860.719 84.31H854.059V81.7L867.019 61.72L871.159 57.76L865.309 58.66H847.489V52H879.619V54.61L865.309 76.12L862.159 78.73V78.91L865.219 78.28C867.619 78.34 869.839 78.79 871.879 79.63C873.919 80.41 875.689 81.58 877.189 83.14C878.689 84.64 879.859 86.47 880.699 88.63C881.539 90.73 881.959 93.13 881.959 95.83C881.959 99.07 881.389 101.95 880.249 104.47C879.109 106.99 877.549 109.12 875.569 110.86C873.649 112.54 871.369 113.83 868.729 114.73C866.089 115.63 863.299 116.08 860.359 116.08C857.659 116.08 855.229 115.87 853.069 115.45C850.909 115.03 849.019 114.49 847.399 113.83L849.289 107.44C850.669 108.1 852.289 108.67 854.149 109.15C856.069 109.57 858.199 109.78 860.539 109.78Z"
                  fill="#7B6442"
                />
                <path
                  name="4"
                  onClick={this.update('4')}
                  d="M0 210.015C0 207.245 2.7203 205 6.07595 205H313.924C317.28 205 320 207.245 320 210.015V372.985C320 375.755 317.28 378 313.924 378H6.07595C2.7203 378 0 375.755 0 372.985V210.015Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('4')}
                  d="M182.639 300.65H172.019V320H164.999V300.65H137.279V297.68L167.159 256.01H172.019V294.35H182.639V300.65ZM164.999 274.73L165.899 267.35H165.629L162.479 273.47L149.789 290.66L145.469 295.07L151.769 294.35H164.999V274.73Z"
                  fill="#7B6442"
                />
                <path
                  name="5"
                  onClick={this.update('5')}
                  d="M352 210.015C352 207.245 354.72 205 358.076 205H665.924C669.28 205 672 207.245 672 210.015V372.985C672 375.755 669.28 378 665.924 378H358.076C354.72 378 352 375.755 352 372.985V210.015Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('5')}
                  d="M506.649 314.78C510.789 314.78 514.209 313.58 516.909 311.18C519.609 308.78 520.959 305.3 520.959 300.74C520.959 296.36 519.609 293.09 516.909 290.93C514.269 288.77 510.609 287.69 505.929 287.69L498.369 288.14V257H526.449V263.66H505.119V281.57L508.989 281.39C514.929 281.45 519.609 283.1 523.029 286.34C526.449 289.58 528.159 294.23 528.159 300.29C528.159 303.65 527.589 306.65 526.449 309.29C525.309 311.87 523.749 314.03 521.769 315.77C519.849 317.51 517.569 318.83 514.929 319.73C512.289 320.63 509.469 321.08 506.469 321.08C503.769 321.08 501.489 320.93 499.629 320.63C497.769 320.33 496.029 319.88 494.409 319.28L496.299 313.16C497.679 313.7 499.149 314.12 500.709 314.42C502.329 314.66 504.309 314.78 506.649 314.78Z"
                  fill="#7B6442"
                />
                <path
                  name="6"
                  onClick={this.update('6')}
                  d="M704 210.015C704 207.245 706.72 205 710.076 205H1017.92C1021.28 205 1024 207.245 1024 210.015V372.985C1024 375.755 1021.28 378 1017.92 378H710.076C706.72 378 704 375.755 704 372.985V210.015Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('6')}
                  d="M883.759 301.01C883.759 303.77 883.339 306.38 882.499 308.84C881.659 311.24 880.429 313.37 878.809 315.23C877.189 317.03 875.179 318.47 872.779 319.55C870.379 320.57 867.649 321.08 864.589 321.08C861.589 321.08 858.889 320.6 856.489 319.64C854.089 318.68 852.019 317.27 850.279 315.41C848.539 313.49 847.189 311.15 846.229 308.39C845.329 305.63 844.879 302.45 844.879 298.85C844.879 292.91 845.629 287.45 847.129 282.47C848.689 277.43 850.819 273.05 853.519 269.33C856.219 265.61 859.399 262.61 863.059 260.33C866.779 257.99 870.799 256.52 875.119 255.92L876.649 261.68C873.289 262.28 870.229 263.42 867.469 265.1C864.709 266.78 862.279 268.85 860.179 271.31C858.139 273.77 856.459 276.53 855.139 279.59C853.819 282.65 852.919 285.8 852.439 289.04C853.399 287.42 855.019 285.95 857.299 284.63C859.579 283.25 862.369 282.56 865.669 282.56C871.309 282.56 875.719 284.18 878.899 287.42C882.139 290.66 883.759 295.19 883.759 301.01ZM876.289 301.73C876.289 297.47 875.299 294.26 873.319 292.1C871.339 289.94 868.279 288.86 864.139 288.86C861.199 288.86 858.649 289.58 856.489 291.02C854.389 292.46 852.919 294.08 852.079 295.88C851.959 296.72 851.899 297.41 851.899 297.95C851.899 298.49 851.899 299.09 851.899 299.75C851.899 301.61 852.139 303.44 852.619 305.24C853.159 307.04 853.969 308.66 855.049 310.1C856.129 311.48 857.449 312.62 859.009 313.52C860.629 314.36 862.519 314.78 864.679 314.78C866.419 314.78 867.979 314.45 869.359 313.79C870.799 313.13 872.029 312.23 873.049 311.09C874.069 309.95 874.849 308.57 875.389 306.95C875.989 305.33 876.289 303.59 876.289 301.73Z"
                  fill="#7B6442"
                />
              <div className={style.custom_button}>
              </div>
                <path
                  name="7"
                  onClick={this.update('7')}
                  d="M0 415.015C0 412.245 2.7203 410 6.07595 410H313.924C317.28 410 320 412.245 320 415.015V577.985C320 580.755 317.28 583 313.924 583H6.07595C2.7203 583 0 580.755 0 577.985V415.015Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('7')}
                  d="M145.379 525L167.969 472.26L171.929 467.85L166.619 468.66H140.969V462H178.589V464.43L152.669 525H145.379Z"
                  fill="#7B6442"
                />
                <path
                  name="8"
                  onClick={this.update('8')}
                  d="M352 415.015C352 412.245 354.72 410 358.076 410H665.924C669.28 410 672 412.245 672 415.015V577.985C672 580.755 669.28 583 665.924 583H358.076C354.72 583 352 580.755 352 577.985V415.015Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('8')}
                  d="M493.599 509.97C493.599 506.19 494.589 502.92 496.569 500.16C498.549 497.34 501.639 494.79 505.839 492.51C504.339 491.61 502.929 490.68 501.609 489.72C500.349 488.7 499.209 487.56 498.189 486.3C497.229 485.04 496.449 483.63 495.849 482.07C495.309 480.51 495.039 478.71 495.039 476.67C495.039 474.33 495.429 472.2 496.209 470.28C497.049 468.36 498.219 466.71 499.719 465.33C501.279 463.95 503.109 462.87 505.209 462.09C507.369 461.31 509.799 460.92 512.499 460.92C515.019 460.92 517.299 461.28 519.339 462C521.379 462.72 523.089 463.71 524.469 464.97C525.909 466.23 527.019 467.73 527.799 469.47C528.579 471.21 528.969 473.13 528.969 475.23C528.969 478.65 528.189 481.68 526.629 484.32C525.069 486.9 522.489 489.45 518.889 491.97C520.449 492.87 521.919 493.86 523.299 494.94C524.739 496.02 525.969 497.22 526.989 498.54C528.069 499.86 528.909 501.36 529.509 503.04C530.109 504.66 530.409 506.52 530.409 508.62C530.409 511.2 529.989 513.57 529.149 515.73C528.309 517.83 527.079 519.66 525.459 521.22C523.839 522.72 521.859 523.92 519.519 524.82C517.179 525.66 514.509 526.08 511.509 526.08C508.629 526.08 506.079 525.66 503.859 524.82C501.639 523.98 499.749 522.84 498.189 521.4C496.689 519.96 495.549 518.28 494.769 516.36C493.989 514.38 493.599 512.25 493.599 509.97ZM523.389 509.07C523.389 507.27 523.029 505.71 522.309 504.39C521.589 503.01 520.629 501.78 519.429 500.7C518.289 499.56 516.969 498.54 515.469 497.64C513.969 496.74 512.409 495.87 510.789 495.03C507.129 497.07 504.519 499.35 502.959 501.87C501.399 504.39 500.619 506.79 500.619 509.07C500.619 510.51 500.859 511.89 501.339 513.21C501.819 514.53 502.539 515.67 503.499 516.63C504.459 517.59 505.629 518.37 507.009 518.97C508.449 519.51 510.099 519.78 511.959 519.78C513.459 519.78 514.899 519.57 516.279 519.15C517.659 518.67 518.859 518.01 519.879 517.17C520.959 516.27 521.799 515.16 522.399 513.84C523.059 512.46 523.389 510.87 523.389 509.07ZM502.059 476.49C502.059 478.17 502.389 479.67 503.049 480.99C503.709 482.25 504.579 483.39 505.659 484.41C506.799 485.43 508.089 486.39 509.529 487.29C510.969 488.13 512.469 488.94 514.029 489.72C516.729 487.62 518.709 485.55 519.969 483.51C521.289 481.47 521.949 479.22 521.949 476.76C521.949 473.7 520.989 471.36 519.069 469.74C517.209 468.06 514.959 467.22 512.319 467.22C510.699 467.22 509.259 467.49 507.999 468.03C506.739 468.57 505.659 469.26 504.759 470.1C503.859 470.94 503.169 471.93 502.689 473.07C502.269 474.15 502.059 475.29 502.059 476.49Z"
                  fill="#7B6442"
                />
                <path
                  name="9"
                  onClick={this.update('9')}
                  d="M704 415.015C704 412.245 706.72 410 710.076 410H1017.92C1021.28 410 1024 412.245 1024 415.015V577.985C1024 580.755 1021.28 583 1017.92 583H710.076C706.72 583 704 580.755 704 577.985V415.015Z"
                  fill="#FFE4B5"
                />
                <path
                  onClick={this.update('9')}
                  d="M844.159 478.08C844.159 475.2 844.579 472.53 845.419 470.07C846.259 467.61 847.489 465.48 849.109 463.68C850.729 461.88 852.739 460.47 855.139 459.45C857.599 458.43 860.449 457.92 863.689 457.92C869.809 457.92 874.579 459.9 877.999 463.86C881.419 467.82 883.129 473.4 883.129 480.6C883.129 487.38 882.349 493.32 880.789 498.42C879.289 503.46 877.189 507.72 874.489 511.2C871.789 514.68 868.579 517.41 864.859 519.39C861.199 521.31 857.209 522.54 852.889 523.08L851.269 517.32C854.749 516.78 857.869 515.76 860.629 514.26C863.449 512.76 865.849 510.87 867.829 508.59C869.869 506.31 871.519 503.73 872.779 500.85C874.039 497.91 874.909 494.73 875.389 491.31C873.769 493.23 871.969 494.58 869.989 495.36C868.069 496.08 865.519 496.44 862.339 496.44C859.879 496.44 857.539 496.05 855.319 495.27C853.159 494.43 851.239 493.23 849.559 491.67C847.879 490.11 846.559 488.19 845.599 485.91C844.639 483.63 844.159 481.02 844.159 478.08ZM851.629 477.36C851.629 481.62 852.739 484.83 854.959 486.99C857.239 489.09 860.209 490.14 863.869 490.14C866.809 490.14 869.329 489.66 871.429 488.7C873.529 487.74 875.029 486.48 875.929 484.92C876.049 484.14 876.109 483.45 876.109 482.85C876.109 482.25 876.109 481.62 876.109 480.96C876.109 478.8 875.839 476.73 875.299 474.75C874.819 472.71 874.069 470.91 873.049 469.35C872.029 467.73 870.679 466.47 868.999 465.57C867.379 464.67 865.459 464.22 863.239 464.22C859.579 464.22 856.729 465.39 854.689 467.73C852.649 470.01 851.629 473.22 851.629 477.36Z"
                  fill="#7B6442"
                />
                <path
                  name="delete"
                  onClick={this.update('delete')}
                  d="M1056 210.015C1056 207.245 1058.72 205 1062.08 205H1369.92C1373.28 205 1376 207.245 1376 210.015V372.985C1376 375.755 1373.28 378 1369.92 378H1062.08C1058.72 378 1056 375.755 1056 372.985V210.015Z"
                  fill="#D1B27D"
                />
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  onClick={this.update('delete')}
                  d="M1245.67 260H1191.03C1188.47 260 1186.27 261.076 1184.8 263.227L1165 292.267L1184.8 321.307C1186.27 323.099 1188.47 324.533 1191.03 324.533H1245.67C1249.7 324.533 1253 321.307 1253 317.363V267.17C1253 263.227 1249.7 260 1245.67 260ZM1234.67 305.173L1229.53 310.193L1216.33 297.286L1203.13 310.193L1198 305.173L1211.2 292.267L1198 279.36L1203.13 274.341L1216.33 287.247L1229.53 274.341L1234.67 279.36L1221.47 292.267L1234.67 305.173Z"
                  fill="#7B6442"
                />
                <path
                  name="0"
                  onClick={this.update('0')}
                  d="M1056 5.01538C1056 2.24546 1058.72 0 1062.08 0H1369.92C1373.28 0 1376 2.24546 1376 5.01538V167.985C1376 170.755 1373.28 173 1369.92 173H1062.08C1058.72 173 1056 170.755 1056 167.985V5.01538Z"
                  fill="#FFE4B5"
                />
                <path
                  d="M1195.35 83.5C1195.35 72.7 1197.09 64.57 1200.57 59.11C1204.11 53.65 1209.24 50.92 1215.96 50.92C1223.22 50.92 1228.47 53.62 1231.71 59.02C1235.01 64.36 1236.66 72.52 1236.66 83.5C1236.66 94.3 1234.89 102.43 1231.35 107.89C1227.87 113.35 1222.74 116.08 1215.96 116.08C1208.82 116.08 1203.6 113.23 1200.3 107.53C1197 101.83 1195.35 93.82 1195.35 83.5ZM1202.82 83.5C1202.82 87.4 1203.06 90.97 1203.54 94.21C1204.08 97.39 1204.89 100.15 1205.97 102.49C1207.05 104.77 1208.4 106.57 1210.02 107.89C1211.7 109.15 1213.68 109.78 1215.96 109.78C1220.52 109.78 1223.85 107.68 1225.95 103.48C1228.11 99.22 1229.19 92.56 1229.19 83.5C1229.19 79.66 1228.95 76.12 1228.47 72.88C1228.05 69.64 1227.3 66.85 1226.22 64.51C1225.2 62.17 1223.85 60.37 1222.17 59.11C1220.49 57.85 1218.42 57.22 1215.96 57.22C1211.46 57.22 1208.13 59.35 1205.97 63.61C1203.87 67.87 1202.82 74.5 1202.82 83.5Z"
                  fill="#7B6442"
                />
                <path
                  name="confirm"
                  onClick={this.send}
                  d="M1056 415.015C1056 412.245 1058.72 410 1062.08 410H1369.92C1373.28 410 1376 412.245 1376 415.015V577.985C1376 580.755 1373.28 583 1369.92 583H1062.08C1058.72 583 1056 580.755 1056 577.985V415.015Z"
                  fill="#63A647"
                />
                <path
                  name="confirm"
                  onClick={this.send}
                  d="M1204.57 526.949C1207.13 526.949 1209.69 525.972 1211.64 524.02L1252.83 482.832C1256.74 478.927 1256.74 472.595 1252.83 468.689C1248.93 464.784 1242.59 464.784 1238.69 468.689L1204.57 502.807L1193.99 492.228C1190.09 488.323 1183.75 488.323 1179.85 492.228C1175.94 496.133 1175.94 502.465 1179.85 506.37L1197.5 524.02C1199.45 525.973 1202.01 526.949 1204.57 526.949Z"
                  fill="white"
                />
              </svg>
            </div>
          </div>
        </div>
      </div>
    );
  }
}

export default KeyboardWindow;
